<!DOCTYPE html>
<html>
<head>
  <title>6 Steps to Create Your First Deep Neural Network using Keras and Python â€“ Gogul Ilango </title>
  
  <link rel="shortcut icon" type="image/png" href="/images/favicon_gi.png"/>
  <link rel="stylesheet" href="https://use.typekit.net/mry7nes.css">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Rubik:wght@300;400;500&display=swap" rel="stylesheet">

  <script type="text/javascript" src="/js/theme.js"></script>
  <meta name="viewport" content="width=device-width, initial-scale=.5, maximum-scale=12.0, minimum-scale=.25, user-scalable=yes"/>

      <meta charset="utf-8" />
    <meta content='text/html; charset=utf-8' http-equiv='Content-Type'>
    <meta http-equiv='X-UA-Compatible' content='IE=edge'>
    <meta name='viewport' content='width=device-width, initial-scale=1.0, maximum-scale=1.0'>

    <meta property="og:title" content="6 Steps to Create Your First Deep Neural Network using Keras and Python" />
    <meta name="description" content="Learn how to create your first Deep Neural Network in few lines of code using Keras and Python" />
    <meta property="og:description" content="Learn how to create your first Deep Neural Network in few lines of code using Keras and Python" />
    <meta property="twitter:title" content="6 Steps to Create Your First Deep Neural Network using Keras and Python" />

    <meta property="og:image" content="https://drive.google.com/uc?id=1541eWZkwlPctAlVmVCPZ36NIGTD_QbEU"/>
    <meta property="og:image:width" content="180" />
    <meta property="og:image:height" content="110" />

    <meta name="twitter:title" content="6 Steps to Create Your First Deep Neural Network using Keras and Python">
    <meta name="twitter:description" content="Learn how to create your first Deep Neural Network in few lines of code using Keras and Python">
    <meta name="twitter:image" content="https://drive.google.com/uc?id=1541eWZkwlPctAlVmVCPZ36NIGTD_QbEU">
  <!-- Begin Jekyll SEO tag v2.8.0 -->
<title>6 Steps to Create Your First Deep Neural Network using Keras and Python | Gogul Ilango</title>
<meta name="generator" content="Jekyll v4.3.2" />
<meta property="og:title" content="6 Steps to Create Your First Deep Neural Network using Keras and Python" />
<meta name="author" content="Gogul Ilango" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Learn how to create your first Deep Neural Network in few lines of code using Keras and Python" />
<meta property="og:description" content="Learn how to create your first Deep Neural Network in few lines of code using Keras and Python" />
<link rel="canonical" href="http://localhost:4000/software/first-neural-network-keras" />
<meta property="og:url" content="http://localhost:4000/software/first-neural-network-keras" />
<meta property="og:site_name" content="Gogul Ilango" />
<meta property="og:image" content="https://drive.google.com/uc?id=1541eWZkwlPctAlVmVCPZ36NIGTD_QbEU" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2016-12-01T00:00:00+05:30" />
<meta name="twitter:card" content="summary_large_image" />
<meta property="twitter:image" content="https://drive.google.com/uc?id=1541eWZkwlPctAlVmVCPZ36NIGTD_QbEU" />
<meta property="twitter:title" content="6 Steps to Create Your First Deep Neural Network using Keras and Python" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"Gogul Ilango"},"dateModified":"2016-12-01T00:00:00+05:30","datePublished":"2016-12-01T00:00:00+05:30","description":"Learn how to create your first Deep Neural Network in few lines of code using Keras and Python","headline":"6 Steps to Create Your First Deep Neural Network using Keras and Python","image":"https://drive.google.com/uc?id=1541eWZkwlPctAlVmVCPZ36NIGTD_QbEU","mainEntityOfPage":{"@type":"WebPage","@id":"http://localhost:4000/software/first-neural-network-keras"},"url":"http://localhost:4000/software/first-neural-network-keras"}</script>
<!-- End Jekyll SEO tag -->


  <!--[if lt IE 9]><script src="http://html5shiv.googlecode.com/svn/trunk/html5.js"></script><![endif]-->
  <!--[if lte IE 8]><script type="text/javascript" src="excanvas.js"></script><![endif]-->
    <meta name="theme-color" content="#000" />
    <link id="main-style-sheet" rel="stylesheet" type="text/css" href="/style.css" />
    <link rel="alternate" type="application/rss+xml" title="Gogul Ilango - This blog is a personal space of Gogul Ilango who writes about technology, music production, programming and travel." href="/feed.xml" />

  </head>

  <body>
    <div class="outer-wrapping">
      <div class="inner-container">
          <div class="topnav header-right" id="top_navigator">
            <a title="home" id = "nav_home" href="/"><span>home</span></a>
            <a title="music" id = "nav_music" href="https://www.youtube.com/gogulilangomusic" target="_blank"><span>music</span></a>
            <a title="theme" id = "nav_theme" class = "nav_theme" onclick="switchTheme(1)"><span>theme</span></a>
            <a href = "javascript:void(0);" style="font-size:14px;" class="icon" onclick="top_navigation()">&#9776;</a>
          </div>
      </div>
    </div>

    <div id="main" role="main">
      <div class="readtime-progress" id="readtime-progress"></div>

<div class="post-heading post-heading-wrapper post-image">
	<div class="grad-post">
		<h1>6 Steps to Create Your First Deep Neural Network using Keras and Python</h1>
		<div class="post-subheading">
			<p>Deep Learning | 01 December 2016</p>
			<p><a href="#show_comments" id="comment-count" class="disqus-comment-count" data-disqus-url="https://gogulilango.com/software/first-neural-network-keras"></a></p>
		</div>
		
<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.5.0/css/font-awesome.min.css">

<div class="share-it-box">
<div id="share-box"> 
		<a href="whatsapp://send?text=http://localhost:4000/software/first-neural-network-keras" data-action="share/whatsapp/share"><img class="icon-whatsapp" src="/images/icons/whatsapp.png"/></a>

        <a href="https://www.facebook.com/sharer/sharer.php?u=http://localhost:4000/software/first-neural-network-keras" onclick="window.open(this.href, 'mywin',
'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;" ><img class="icon-facebook" src="/images/icons/facebook.png"/></a>
       
        <a href="https://twitter.com/intent/tweet?text=6 Steps to Create Your First Deep Neural Network using Keras and Python&url=http://localhost:4000/software/first-neural-network-keras" onclick="window.open(this.href, 'mywin',
'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;"><img class="icon-twitter" src="/images/icons/twitter.png"/></a>

       <a href="https://www.linkedin.com/shareArticle?mini=true&url=http://localhost:4000/software/first-neural-network-keras&title=6 Steps to Create Your First Deep Neural Network using Keras and Python&summary=Learn how to create your first Deep Neural Network in few lines of code using Keras and Python&source=webjeda" onclick="window.open(this.href, 'mywin',
'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;" ><img class="icon-linkedin" src="/images/icons/linkedin.png"/></a>                               
</div>
</div>
	</div>
</div>

<div class="containing">
	<div class="wrapping">

		<!--<div class="share-box">
	<button class="top-share-fab" id="top-share-fab" onclick="showShareBox(this.id)"></button>
	<div id="top-share-box" class="top-share-box">
		<h5>Share</h5>
		<ul>
			<li class="whatsapp-white"><a href="whatsapp://send?text=http://localhost:4000/software/first-neural-network-keras" data-action="share/whatsapp/share">WhatsApp</a></li>
			<li class="facebook-white"><a href="https://www.facebook.com/sharer/sharer.php?u=http://localhost:4000/software/first-neural-network-keras" onclick="window.open(this.href, 'mywin', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;" >Facebook</a></li>
			<li class="twitter-white"><a href="https://twitter.com/intent/tweet?text=6 Steps to Create Your First Deep Neural Network using Keras and Python&url=http://localhost:4000/software/first-neural-network-keras" onclick="window.open(this.href, 'mywin', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;">Twitter</a></li>
			<li class="linkedin-white"><a href="https://www.linkedin.com/shareArticle?mini=true&url=http://localhost:4000/software/first-neural-network-keras&title=6 Steps to Create Your First Deep Neural Network using Keras and Python&summary=Learn how to create your first Deep Neural Network in few lines of code using Keras and Python&source=webjeda" onclick="window.open(this.href, 'mywin', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;" >LinkedIn</a></li>
		</ul>
	</div>
</div>-->

		<div class="post-cover">
			<div class="carbon_advertisement">
				<div class="carbon_advertisement_wrapper">
					<script async type="text/javascript" src="//cdn.carbonads.com/carbon.js?serve=CK7I623I&placement=gogul09githubio" id="_carbonads_js"></script>
				</div>
			</div>
			<article class="post">
				<div class="entry">
					<div class="git-showcase">
  <div>
    <a class="github-button" href="https://github.com/Gogul09" data-show-count="true" aria-label="Follow @Gogul09 on GitHub">Follow @Gogul09</a>
  </div>

  <div>
    <a class="github-button" href="https://github.com/Gogul09/deep-learning-fundamentals/fork" data-icon="octicon-repo-forked" data-show-count="true" aria-label="Fork Gogul09/deep-learning-fundamentals on GitHub">Fork</a>
  </div>

  <div>
    <a class="github-button" href="https://github.com/Gogul09/deep-learning-fundamentals" data-icon="octicon-star" data-show-count="true" aria-label="Star Gogul09/deep-learning-fundamentals on GitHub">Star</a>
  </div>  
</div>

<div class="sidebar_tracker" id="sidebar_tracker">
  <button onclick="closeSidebar('sidebar_tracker_content')">X</button>
  <p onclick="showSidebar('sidebar_tracker_content')">Contents</p>
  <ul id="sidebar_tracker_content">
    <li><a class="sidebar_links" onclick="handleSideBarLinks(this.id)" id="link_1" href="#deep-learning-environment-setup">Deep Learning Environment Setup</a></li>
    <li><a class="sidebar_links" onclick="handleSideBarLinks(this.id)" id="link_2" href="#deep-learning-flowchart">Deep Learning Flowchart</a></li>
    <li><a class="sidebar_links" onclick="handleSideBarLinks(this.id)" id="link_3" href="#analyse-the-dataset">1. Analyse the Dataset</a></li>
    <li><a class="sidebar_links" onclick="handleSideBarLinks(this.id)" id="link_4" href="#prepare-the-dataset">2. Prepare the dataset</a></li>
    <li><a class="sidebar_links" onclick="handleSideBarLinks(this.id)" id="link_5" href="#create-the-model">3. Create the Model</a></li>
    <li><a class="sidebar_links" onclick="handleSideBarLinks(this.id)" id="link_6" href="#compile-the-model">4. Compile the model</a></li>
    <li><a class="sidebar_links" onclick="handleSideBarLinks(this.id)" id="link_7" href="#fit-the-model">5. Fit the model</a></li>
    <li><a class="sidebar_links" onclick="handleSideBarLinks(this.id)" id="link_8" href="#evaluate-the-model">6. Evaluate the model</a></li>
    <li><a class="sidebar_links" onclick="handleSideBarLinks(this.id)" id="link_9" href="#complete-code">Complete code</a></li>
    <li><a class="sidebar_links" onclick="handleSideBarLinks(this.id)" id="link_10" href="#summary">Summary</a></li>
  </ul>
</div>

<p><strong>When I began to study Neural Networks during my coursework, I realized the complexity involved in representing those large layers of neurons in code. But when I read about <a href="https://keras.io/" target="_blank">Keras</a> and started experimenting with it, everything was super easy to understand and perfectly made sense.</strong></p>

<p>To all those who want to actually write some code to build a Deep Neural Network, but donâ€™t know where to begin, I highly suggest you to visit <a href="https://keras.io/" target="_blank">Keras</a> website as well as itâ€™s <a href="https://github.com/fchollet/keras" target="_blank">github</a> page.</p>

<blockquote>
  <p><strong>Update</strong>: As Python2 faces <a href="https://pythonclock.org/">end of life</a>, the below code only supports <strong>Python3</strong>.</p>
</blockquote>

<p>In this post, we will learn the simple 6 steps with which we can create our first deep neural network using Keras and Python. Letâ€™s get started!</p>

<div class="code-head">Objectives<span>goals</span></div>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre></td><td class="rouge-code"><pre>* How to setup environment to create Deep Neural Nets?
* How to analyze and understand a training dataset?
* How to load and work with .csv file in Python?
* How to work with Keras, NumPy and Python for Deep Learning?
* How to create a Deep Neural Net in less than 5 minutes?
* How to split training and testing data for evaluating our model?
* How to display metrics to analyze performance of our model?
</pre></td></tr></tbody></table></code></pre></div></div>

<h3 id="deep-learning-environment-setup">Deep Learning Environment Setup</h3>

<p>Before getting into concept and code, we need some libraries to get started with Deep Learning in Python. Copy and paste the below commands line-by-line to install all the dependencies needed for Deep Learning using Keras in Linux. I used Ubuntu 14.04 LTS 64-bit architecture as my OS and I didnâ€™t use any GPU to speed up computations for this tutorial.</p>

<div class="code-head"><span>cmd</span>dependencies</div>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
</pre></td><td class="rouge-code"><pre>sudo pip install numpy
sudo pip install scipy
sudo pip install matplotlib
sudo pip install seaborn
sudo pip install scikit-learn
sudo pip install pillow
sudo pip install h5py
sudo pip install --upgrade --no-deps git+git://github.com/Theano/Theano.git
sudo pip install tensorflow
sudo pip install keras
</pre></td></tr></tbody></table></code></pre></div></div>

<p>Keras needs <strong>Theano</strong> or <strong>TensorFlow</strong> as its backend to perform numerical computations. TensorFlow wonâ€™t work in Ubuntu 32-bit architecture (at the time of writing this tutorial). So, better have a 64-bit OS to properly install Keras with both TensorFlow and Theano backend.</p>

<p>If you need to work with Deep Learning on a Windows machine, please visit my post on environment setup for Windows <a href="https://gogul09.github.io/software/deep-learning-windows" target="_blank">here</a>.</p>

<h3 id="deep-learning-flowchart">Deep Learning flowchart</h3>

<p>Letâ€™s talk about the classic <a href="https://en.wikipedia.org/wiki/Supervised_learning" target="_blank">Supervised Learning</a> problem.</p>

<figure>
  <img src="/images/software/first-neural-network-keras/supervised-learning.png" />
  <figcaption>Figure 1. Supervised Learning</figcaption>
</figure>

<p>Supervised Learning means we have a set of <strong>training data</strong> along with its outcomes (<strong>classes</strong> or <strong>real values</strong>). We train a deep learning model with the training data so that the model will be in a position to predict the outcome (<strong>class</strong> or <strong>real value</strong>) of future unseen data (or test data).</p>

<p>This problem has two sub-divisions namely <strong>Classification</strong> and <strong>Regression</strong>.</p>

<ul>
  <li><strong>Classification</strong> - If the output variable to be predicted by our model is a <strong>label</strong> or a <strong>category</strong>, then it is a Classification problem. <em>Ex: Predicting the name of a flower species.</em></li>
  <li><strong>Regression</strong> - If the output variable to be predicted by our model is a <strong>real</strong> or <strong>continuous</strong> value (integer, float), then it is a Regression problem. <em>Ex: Predicting the stock price of a company.</em></li>
</ul>

<p>We will concentrate on a Supervised Learning Classification problem and learn how to implement a Deep Neural Network in code using Keras.</p>

<div class="note"><p>
<b>Note</b>: To learn more about Deep Learning theory, I highly suggest you to register in Andrew NG's <a href="https://www.coursera.org/learn/machine-learning" target="_blank">machine learning course</a> and <a href="https://www.coursera.org/specializations/deep-learning" target="_blank">deep learning course</a> at Coursera or visit <a href="http://deeplearning.stanford.edu/tutorial/" target="_blank">Stanford University's</a> awesome website.
</p></div>

<p>Download the below image for your future reference. Any complex problem related to Supervised Learning can be solved using this flowchart. We will walk through each step one-by-one in detail.</p>

<figure>
	<img src="/images/software/first-neural-network-keras/Deep Learning flow.jpg" />
	<figcaption>Figure 2. Keras Flow Chart for Deep Learning</figcaption>
</figure>

<h3 id="analyse-the-dataset">Analyse the Dataset</h3>

<blockquote>
  <p>Deep Learning is all about <strong>Data</strong> and <strong>Computational Power</strong>.</p>
</blockquote>

<p>You read it right! The first step in any Deep Learning problem is to collect more data to work with, analyse the data thoroughly and understand the various parameters/attributes in it. Attributes (also called as features) to look at in any dataset are as follows.</p>

<ul>
  <li><strong>Dataset characteristics</strong> - Multivariate, Univariate, Sequential, Time-series, Text.</li>
  <li><strong>Attribute characteristics</strong> - Real, Integers, Strings, Float, Binary.</li>
  <li><strong>Number of Instances</strong> - Total number of rows.</li>
  <li><strong>Number of Attributes</strong> - Total number of columns.</li>
  <li><strong>Associated Tasks</strong> - Classification, Regression, Clustering, Other problem.</li>
</ul>

<p>For this tutorial, we will use the <a href="https://www.kaggle.com/uciml/pima-indians-diabetes-database/data" target="_blank">Pima Indian Diabetes Dataset</a> from Kaggle. This dataset contains the patient medical record data for Pima Indians and tell us whether they had an onset of diabetes within 5 years or not (last column in the dataset). It is typically a <strong>binary classification</strong> problem where</p>

<ul>
  <li><strong>1 = yes!</strong> the patient had an onset of diabetes in 5 years.</li>
  <li><strong>0 = no!</strong> the patient had no onset of diabetes in 5 years.</li>
</ul>

<p>In this dataset, there are 8 attributes (i.e 8 columns) that describes each patient (i.e a single row) and a total of 768 instances (i.e total number of rows or number of patients).</p>

<p>Go to this <a href="https://www.kaggle.com/uciml/pima-indians-diabetes-database/data" target="_blank">link</a>, register/login, download the dataset, save it inside a folder named <strong>pima-indians-diabetes</strong> and rename it as <strong>dataset.csv</strong>. Below is the folder structure to follow.</p>

<div class="code-head"><span>rule</span>folder structure</div>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre></td><td class="rouge-code"><pre><span class="o">|--</span><span class="n">pima</span><span class="o">-</span><span class="n">indians</span><span class="o">-</span><span class="n">diabetes</span>
<span class="o">|--|--</span><span class="n">dataset</span><span class="p">.</span><span class="n">csv</span>
<span class="o">|--|--</span><span class="n">train</span><span class="p">.</span><span class="n">py</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<h3 id="prepare-the-dataset">Prepare the dataset</h3>

<blockquote>
  <p>Data must be represented in a <strong>structured way</strong> for computers to understand.</p>
</blockquote>

<p>Representing our analyzed data is the next step to do in Deep Learning. Data will be represented as an <strong>n-dimensional matrix</strong> in most of the cases (whether it is numerical or images or videos). Some of the common file-formats to store matrices are <a href="https://en.wikipedia.org/wiki/Comma-separated_values" target="_blank">csv</a>, <a href="https://docs.python.org/2.2/lib/module-cPickle.html" target="_blank">cPickle</a> and <a href="http://www.h5py.org/" target="_blank">h5py</a>. If you have millions of data (say millions of images), <strong>h5py</strong> is the file-format of choice. We will stick with <strong>CSV</strong> file-format in this tutorial.</p>

<p>CSV (Comma Separated Values) file formats can easily be loaded in Python in two ways. One using <a href="http://www.numpy.org/" target="_blank">NumPy</a> and other using <a href="https://pandas.pydata.org/" target="_blank">Pandas</a>. We will use <strong>NumPy</strong>.</p>

<p>Below is the code to import all the necessary libraries and load the pima-indians diabetes dataset.</p>

<div class="code-head"><span>code</span>train.py</div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
</pre></td><td class="rouge-code"><pre><span class="c1"># organize imports
</span><span class="kn">from</span> <span class="n">keras.models</span> <span class="kn">import</span> <span class="n">Sequential</span>
<span class="kn">from</span> <span class="n">keras.models</span> <span class="kn">import</span> <span class="n">Dense</span>
<span class="kn">from</span> <span class="n">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">train_test_split</span>
<span class="kn">import</span> <span class="n">numpy</span> <span class="k">as</span> <span class="n">np</span>

<span class="c1"># seed for reproducing same results
</span><span class="n">seed</span> <span class="o">=</span> <span class="mi">9</span>
<span class="n">np</span><span class="p">.</span><span class="n">random</span><span class="p">.</span><span class="nf">seed</span><span class="p">(</span><span class="n">seed</span><span class="p">)</span>

<span class="c1"># load pima indians dataset
</span><span class="n">dataset</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">loadtxt</span><span class="p">(</span><span class="sh">'</span><span class="s">dataset.csv</span><span class="sh">'</span><span class="p">,</span> <span class="n">delimiter</span><span class="o">=</span><span class="sh">'</span><span class="s">,</span><span class="sh">'</span><span class="p">,</span> <span class="n">skiprows</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="c1"># split into input and output variables
</span><span class="n">X</span> <span class="o">=</span> <span class="n">dataset</span><span class="p">[:,</span><span class="mi">0</span><span class="p">:</span><span class="mi">8</span><span class="p">]</span>
<span class="n">Y</span> <span class="o">=</span> <span class="n">dataset</span><span class="p">[:,</span><span class="mi">8</span><span class="p">]</span>

<span class="c1"># split the data into training (67%) and testing (33%)
</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">Y_train</span><span class="p">,</span> <span class="n">Y_test</span><span class="p">)</span> <span class="o">=</span> <span class="nf">train_test_split</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="mf">0.33</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="n">seed</span><span class="p">)</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<ul>
  <li>Line (1-3) handles the imports to build our deep learning model using Keras.</li>
  <li>Line (6-7) fix a seed for reproducing same results if we wish to train and evaluate our network more than once.</li>
  <li>Line (10) loads the dataset from the <strong>.csv file</strong> saved on disk. It uses an argument <span class="coding">delimiter</span> to inform NumPy that all attributes are separated by <strong>,</strong> in the <strong>.csv file</strong>.</li>
  <li>Line (13-14) splits the dataset into input and output variables.
    <ul>
      <li>X has all the 8 attributes of the patients</li>
      <li>Y has whether they have an onset of diabetes or not.</li>
    </ul>
  </li>
  <li>Line (17) splits the dataset into training (67%) and testing (33%) using the scikit-learnâ€™s <span class="coding">train_test_split</span> function. By performing this split, we can easily verify the performance of our model in an unseen test dataset.</li>
</ul>

<h3 id="create-the-model">Create the Model</h3>

<p>In Keras, a model is created using <span class="coding">Sequential</span>. You may wanna recall that Neural Networks holds large number of neurons residing inside several sequential layers.</p>

<p>We will create a model that has fully connected layers, which means all the neurons are connected from one layer to its next layer. This is achieved in Keras with the help of <span class="coding">Dense</span> function.</p>

<figure>
	<img src="/images/software/first-neural-network-keras/Network Architecture.jpg" />
	<figcaption>Figure 3. Our First Deep Neural Network Architecture</figcaption>
</figure>

<p>We will use the above Deep Neural Network architecture which has a <strong>single input layer</strong>, <strong>2 hidden layers</strong> and a <strong>single output layer</strong>.</p>

<p>The input data which is of size 8 is sent to the first hidden layer that has randomly initialized 8 neurons. This is a very useful approach, if we donâ€™t have any clue about the no.of.neurons to specify at the very first attempt. From here, we can easily perform trial-and-error procedure to increase the network architecture to produce good results. The next hidden layer has 6 neurons and the final output layer has 1 neuron that outputs whether the patient has an onset of diabetes or not.</p>

<p>Figure 4 shows our Deep Neural Network with an input layer, a hidden layer having 8 neurons, a hidden layer having 6 neurons and an output layer with a single neuron.</p>

<figure>
  <img src="/images/software/first-neural-network-keras/mlp-1.png" />
  <figcaption>Figure 4. Our First Deep Neural Network (Multi-Layer Perceptron)</figcaption>
</figure>

<p>Below are the four lines of code to create the above architecture.</p>

<div class="code-head"><span>code</span>train.py</div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre></td><td class="rouge-code"><pre><span class="c1"># create the model
</span><span class="n">model</span> <span class="o">=</span> <span class="nc">Sequential</span><span class="p">()</span>
<span class="n">model</span><span class="p">.</span><span class="nf">add</span><span class="p">(</span><span class="nc">Dense</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="n">input_dim</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">init</span><span class="o">=</span><span class="sh">'</span><span class="s">uniform</span><span class="sh">'</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="sh">'</span><span class="s">relu</span><span class="sh">'</span><span class="p">))</span>
<span class="n">model</span><span class="p">.</span><span class="nf">add</span><span class="p">(</span><span class="nc">Dense</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="n">init</span><span class="o">=</span><span class="sh">'</span><span class="s">uniform</span><span class="sh">'</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="sh">'</span><span class="s">relu</span><span class="sh">'</span><span class="p">))</span>
<span class="n">model</span><span class="p">.</span><span class="nf">add</span><span class="p">(</span><span class="nc">Dense</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">init</span><span class="o">=</span><span class="sh">'</span><span class="s">uniform</span><span class="sh">'</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="sh">'</span><span class="s">sigmoid</span><span class="sh">'</span><span class="p">))</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<ul>
  <li>Line (1) creates a <span class="coding">Sequential</span> model to add layers one at a time.</li>
  <li>Line (2), the first layer expects four arguments:
    <ul>
      <li><span class="coding">8</span>: No.of.neurons present in that layer.</li>
      <li><span class="coding">input_dim</span>: specify the dimension of the input data.</li>
      <li><span class="coding">init</span>: specify whether <span class="coding">uniform</span> or  <span class="coding">normal</span> distribution of weights to be initialized.</li>
      <li><span class="coding">activation</span>: specify whether <span class="coding">relu</span> or <span class="coding">sigmoid</span> or <span class="coding">tanh</span> activation function to be used for each neuron in that layer.</li>
    </ul>
  </li>
  <li>Line (3), the next hidden layer has 6 neurons with an <span class="coding">uniform</span> initialization of weights and <span class="coding">relu</span> activation function</li>
  <li>Line (4), the output layer has only one neuron as this is a binary classification problem. The activation function at output is <span class="coding">sigmoid</span> because it outputs a probability in the range 0 and 1 so that we could easily discriminate output by assigning a threshold.</li>
</ul>

<h3 id="compile-the-model">Compile the model</h3>

<p>After creating the model, three parameters are needed to compile the model in Keras.</p>
<ul>
  <li><span class="coding">loss</span>: This is used to evaluate a set of weights. It is needed to reduce the error between actual output and expected output. It could be <span class="coding">binary_crossentropy</span> or <span class="coding">categorical_crossentropy</span> depending on the problem. As we are dealing with a binary classification problem, we need to pick <span class="coding">binary_crossentropy</span>. <a href="https://keras.io/losses/" target="_blank">Here</a> is the list of loss functions available in Keras.</li>
  <li><span class="coding">optimizer</span>: This is used to search through different weights for the network. It could be <span class="coding">adam</span> or <span class="coding">rmsprop</span> depending on the problem. <a href="https://keras.io/optimizers/" target="_blank">Here</a> is the list of optimizers available in Keras.</li>
  <li><span class="coding">metrics</span>: This is used to collect the report during training. Normally, we pick <span class="coding">accuracy</span> as our performance metric. <a href="https://keras.io/metrics/" target="_blank">Here</a> is the list of metrics available in Keras.</li>
</ul>

<p>These parameters are to be tuned according to the problem as our model needs some optimization in the background (which is taken care by <strong>Theano</strong> or <strong>TensorFlow</strong>) so that it learns from the data during each epoch (which means reducing the error between actual output and predicted output).</p>

<p><span class="coding">epoch</span> is the term used to denote the number of iterations involved during the training process of a neural network.</p>

<div class="code-head"><span>code</span>train.py</div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre></td><td class="rouge-code"><pre><span class="c1"># compile the model
</span><span class="n">model</span><span class="p">.</span><span class="nf">compile</span><span class="p">(</span><span class="n">loss</span><span class="o">=</span><span class="sh">'</span><span class="s">binary_crossentropy</span><span class="sh">'</span><span class="p">,</span> <span class="n">optimizer</span><span class="o">=</span><span class="sh">'</span><span class="s">adam</span><span class="sh">'</span><span class="p">,</span> <span class="n">metrics</span><span class="o">=</span><span class="p">[</span><span class="sh">'</span><span class="s">accuracy</span><span class="sh">'</span><span class="p">])</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<ul>
  <li>Line (2) chooses a <span class="coding">binary_crossentropy</span> loss function and the famous Stochastic Gradient Descent (SGD) optimizer <span class="coding">adam</span>. It also collects the <span class="coding">accuracy</span> metric for training.</li>
</ul>

<h3 id="fit-the-model">Fit the model</h3>

<p>After compiling the model, the dataset must be fitted with the model. The <span class="coding">fit()</span> function in Keras expects five arguments -</p>

<ul>
  <li><span class="coding">X_train</span>: the input training data.</li>
  <li><span class="coding">Y_train</span>: the output training classes.</li>
  <li><span class="coding">validation_data</span>: Tuple of testing or validation data used to check the performance of our network.</li>
  <li><span class="coding">nb_epoch</span>: how much iterations should the training process take place.</li>
  <li><span class="coding">batch_size</span>: No.of.instances that are evaluated before performing a weight update in the network.</li>
</ul>

<div class="code-head"><span>code</span>train.py</div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre></td><td class="rouge-code"><pre><span class="c1"># fit the model
</span><span class="n">model</span><span class="p">.</span><span class="nf">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">Y_train</span><span class="p">,</span> <span class="n">validation_data</span><span class="o">=</span><span class="p">(</span><span class="n">X_test</span><span class="p">,</span> <span class="n">Y_test</span><span class="p">),</span> <span class="n">nb_epoch</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">batch_size</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<ul>
  <li>Line (2) chooses <strong>100 iterations</strong> to be performed by the deep neural network with a <span class="coding">batch_size</span> of <strong>5</strong>.</li>
</ul>

<h3 id="evaluate-the-model">Evaluate the model</h3>

<p>After fitting the dataset to the model, the model needs to be evaluated. Evaluating the trained model with an unseen test dataset shows how our model predicts output on unseen data. The <span class="coding">evaluate()</span> function in Keras expects two arguments.</p>

<ul>
  <li><span class="coding">X</span> - the input data.</li>
  <li><span class="coding">Y</span> - the output data.</li>
</ul>

<div class="code-head"><span>code</span>train.py</div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre></td><td class="rouge-code"><pre><span class="c1"># evaluate the model
</span><span class="n">scores</span> <span class="o">=</span> <span class="n">model</span><span class="p">.</span><span class="nf">evaluate</span><span class="p">(</span><span class="n">X_test</span><span class="p">,</span> <span class="n">Y_test</span><span class="p">)</span>
<span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="s">Accuracy: %.2f%%</span><span class="sh">"</span> <span class="o">%</span><span class="p">(</span><span class="n">scores</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="mi">100</span><span class="p">))</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<h3 id="complete-code">Complete code</h3>
<p>Excluding comments and empty new lines, we have combined all the 6 steps together and created our first Deep Neural Network model using 18 lines of code. Below is the entire code of the model we have just built.</p>

<div class="code-head"><span>code</span>train.py</div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
</pre></td><td class="rouge-code"><pre><span class="c1"># organize imports
</span><span class="kn">from</span> <span class="n">keras.models</span> <span class="kn">import</span> <span class="n">Sequential</span>
<span class="kn">from</span> <span class="n">keras.layers</span> <span class="kn">import</span> <span class="n">Dense</span>
<span class="kn">from</span> <span class="n">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">train_test_split</span>
<span class="kn">import</span> <span class="n">numpy</span> <span class="k">as</span> <span class="n">np</span>

<span class="c1"># seed for reproducing same results
</span><span class="n">seed</span> <span class="o">=</span> <span class="mi">9</span>
<span class="n">np</span><span class="p">.</span><span class="n">random</span><span class="p">.</span><span class="nf">seed</span><span class="p">(</span><span class="n">seed</span><span class="p">)</span>

<span class="c1"># load pima indians dataset
</span><span class="n">dataset</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">loadtxt</span><span class="p">(</span><span class="sh">'</span><span class="s">dataset.csv</span><span class="sh">'</span><span class="p">,</span> <span class="n">delimiter</span><span class="o">=</span><span class="sh">'</span><span class="s">,</span><span class="sh">'</span><span class="p">,</span> <span class="n">skiprows</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="c1"># split into input and output variables
</span><span class="n">X</span> <span class="o">=</span> <span class="n">dataset</span><span class="p">[:,</span><span class="mi">0</span><span class="p">:</span><span class="mi">8</span><span class="p">]</span>
<span class="n">Y</span> <span class="o">=</span> <span class="n">dataset</span><span class="p">[:,</span><span class="mi">8</span><span class="p">]</span>

<span class="c1"># split the data into training (67%) and testing (33%)
</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">Y_train</span><span class="p">,</span> <span class="n">Y_test</span><span class="p">)</span> <span class="o">=</span> <span class="nf">train_test_split</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="mf">0.33</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="n">seed</span><span class="p">)</span>

<span class="c1"># create the model
</span><span class="n">model</span> <span class="o">=</span> <span class="nc">Sequential</span><span class="p">()</span>
<span class="n">model</span><span class="p">.</span><span class="nf">add</span><span class="p">(</span><span class="nc">Dense</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="n">input_dim</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">init</span><span class="o">=</span><span class="sh">'</span><span class="s">uniform</span><span class="sh">'</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="sh">'</span><span class="s">relu</span><span class="sh">'</span><span class="p">))</span>
<span class="n">model</span><span class="p">.</span><span class="nf">add</span><span class="p">(</span><span class="nc">Dense</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="n">init</span><span class="o">=</span><span class="sh">'</span><span class="s">uniform</span><span class="sh">'</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="sh">'</span><span class="s">relu</span><span class="sh">'</span><span class="p">))</span>
<span class="n">model</span><span class="p">.</span><span class="nf">add</span><span class="p">(</span><span class="nc">Dense</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">init</span><span class="o">=</span><span class="sh">'</span><span class="s">uniform</span><span class="sh">'</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="sh">'</span><span class="s">sigmoid</span><span class="sh">'</span><span class="p">))</span>

<span class="c1"># compile the model
</span><span class="n">model</span><span class="p">.</span><span class="nf">compile</span><span class="p">(</span><span class="n">loss</span><span class="o">=</span><span class="sh">'</span><span class="s">binary_crossentropy</span><span class="sh">'</span><span class="p">,</span> <span class="n">optimizer</span><span class="o">=</span><span class="sh">'</span><span class="s">adam</span><span class="sh">'</span><span class="p">,</span> <span class="n">metrics</span><span class="o">=</span><span class="p">[</span><span class="sh">'</span><span class="s">accuracy</span><span class="sh">'</span><span class="p">])</span>

<span class="c1"># fit the model
</span><span class="n">model</span><span class="p">.</span><span class="nf">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">Y_train</span><span class="p">,</span> <span class="n">validation_data</span><span class="o">=</span><span class="p">(</span><span class="n">X_test</span><span class="p">,</span> <span class="n">Y_test</span><span class="p">),</span> <span class="n">nb_epoch</span><span class="o">=</span><span class="mi">200</span><span class="p">,</span> <span class="n">batch_size</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

<span class="c1"># evaluate the model
</span><span class="n">scores</span> <span class="o">=</span> <span class="n">model</span><span class="p">.</span><span class="nf">evaluate</span><span class="p">(</span><span class="n">X_test</span><span class="p">,</span> <span class="n">Y_test</span><span class="p">)</span>
<span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="s">Accuracy: %.2f%%</span><span class="sh">"</span> <span class="o">%</span> <span class="p">(</span><span class="n">scores</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="mi">100</span><span class="p">))</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<ul>
  <li>Save the code with a filename <span class="coding">train.py</span> in the same folder as the dataset.</li>
  <li>Open up a command prompt and go to that folder.</li>
  <li>Type <span class="coding">python train.py</span></li>
</ul>

<p>I got an accuracy of <strong>72.83%</strong> which is pretty good in our first try without any hyperparameter tuning or changing the network architecture.</p>

<p>Kindly post your results in the comments after tuning around with <span class="coding">nb_epoch</span>, <span class="coding">batch_size</span>, <span class="coding">activation</span>, <span class="coding">init</span>, <span class="coding">optimizer</span> and <span class="coding">loss</span>. You can also increase the number of hidden layers and the number of neurons in each hidden layer.</p>

<h3 id="summary">Summary</h3>
<p>Thus, we have built our first Deep Neural Network (Multi-layer Perceptron) using Keras and Python in a matter of minutes. Note that we havenâ€™t even touched any math involved behind these Deep Neural Networks as it needs a separate post to understand. We have strictly focused on how to solve a supervised learning classification problem using Keras and Python.</p>

				</div>
				<div class="note closers">
	<p>In case if you found something useful to add to this article or you found a bug in the code or would like to improve some points mentioned, feel free to write it down in the comments. Hope you found something useful here.</p>
</div>
			</article>
			
			<div class="show-comments" onclick="showComments()"><p id="show_comments"><span id="comment_count" class="disqus-comment-count" data-disqus-url="https://gogulilango.com/software/first-neural-network-keras"></span></p></div>

			<div id="disqus_thread"></div>
			<script>
				var disqus_config = function () {
				  this.page.url = 'http://localhost:4000/software/first-neural-network-keras';
				  this.page.identifier = 'http://localhost:4000/software/first-neural-network-keras';
				};

				(function() {
				  var d = document, s = d.createElement('script');
				  s.src = 'https://gogul09.disqus.com/embed.js';
				  s.setAttribute('data-timestamp', +new Date());
				  (d.head || d.body).appendChild(s);
				})();
			</script>
			<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
		</div>
	</div>
</div>

<script type="text/javascript">
	
	window.onscroll = function() {
		sideBarScrollHandler();
		windowScrollHandler();
	};
	
	function sideBarScrollHandler() {
		if (document.body.scrollTop > 350 || document.documentElement.scrollTop > 350) {
			document.getElementById("sidebar_tracker").style.top = "20px";
		} else {
			document.getElementById("sidebar_tracker").style.top = "70px";
		}
	}
	
</script>

<script type="text/javascript" src="/js/readtime.js"></script>
    </div>

    <div class="wrapper-footer">
      <footer class="footer">
        <p><span>&copy; 2024 - gogul ilango | opinions are my own</span></p>
       </footer>
     </div>

     <button onclick="topScroller()" id="btnScrollTop" title="Go to top" class="w3-animate-bottom"></button>

     <script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML" type="text/javascript"></script>
     <script src="https://apis.google.com/js/platform.js"></script>
     <script async defer src="https://buttons.github.io/buttons.js"></script>
     <script id="dsq-count-scr" src="//gogul09.disqus.com/count.js" async></script>
     <script src="/js/custom.js"></script>
     
	<!-- Google Analytics -->
	<script>
		(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
		(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
		m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
		})(window,document,'script','//www.google-analytics.com/analytics.js','ga');

		ga('create', 'UA-93019594-1', 'auto');
		ga('send', 'pageview', {
		  'page': '/software/first-neural-network-keras',
		  'title': '6 Steps to Create Your First Deep Neural Network using Keras and Python'
		});
	</script>
	<!-- End Google Analytics -->

   </body>
</html>
